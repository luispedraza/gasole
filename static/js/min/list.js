eval(function(a,e,b,c,d,f){d=function(a){return(a<e?"":d(parseInt(a/e)))+(35<(a%=e)?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){for(;b--;)f[d(b)]=c[b]||d(b);c=[function(a){return f[a]}];d=function(){return"\\w+"};b=1}for(;b--;)c[b]&&(a=a.replace(RegExp("\\b"+d(b)+"\\b","g"),c[b]));return a}('5 J(b,a){b.17().V(J,n.o.32);4.F=b;4.2F=b.17().2r();4.P=a;4.B=s;4.q=s;4.X=s;4.1j=t;4.L(b.u())}J.6.2E=5(){7 d=4;7 g;7 f;4.q=3C.3x("2a");4.q.5m=4.2F;9(4.1j){4.27()}4.4I().4F.4A(4.q);n.o.z.1L(4.u(),"4i",5(){f=g});n.o.z.1E(4.q,"44",5(){g=K;f=t});n.o.z.1E(4.q,"2N",5(e){g=t;9(!f){7 c;7 b;7 a=d.F.17();n.o.z.W(a,"2N",d.F);n.o.z.W(a,"40",d.F);9(a.2C()){b=a.1w();c=d.F.1y();a.u().1V(c);1O(5(){a.u().1V(c);9(b!==s&&(a.u().1a()>b)){a.u().3O(b+1)}},3F)}e.3B=K;9(e.2n){e.2n()}}});n.o.z.1E(4.q,"2f",5(){7 a=d.F.17();n.o.z.W(a,"2f",d.F)});n.o.z.1E(4.q,"2B",5(){7 a=d.F.17();n.o.z.W(a,"2B",d.F)})};J.6.2G=5(){9(4.q&&4.q.2T){4.1N();n.o.z.5d(4.q);4.q.2T.55(4.q);4.q=s}};J.6.3f=5(){9(4.1j){7 a=4.28(4.B);4.q.13.1F=a.y+"A";4.q.13.1M=a.x+"A"}};J.6.1N=5(){9(4.q){4.q.13.38="2W"}4.1j=t};J.6.27=5(){9(4.q){7 a=4.28(4.B);4.q.13.4r=4.2V(a);9(4.F.12){4.q.2S="<4d 4a=\'"+4.2c+"\'><2a 13=\'21: 2Q; 1F: 2P; 1M: 2P; 1c: "+4.Z+"A;\'>"+4.X.1d+"</2a>"}E{4.q.2S=4.X.1d}9(1p 4.X.15==="1f"||4.X.15===""){4.q.15=4.F.17().2K()}E{4.q.15=4.X.15}4.q.13.38=""}4.1j=K};J.6.2I=5(a){4.X=a;7 b=v.3Y(0,a.2D-1);b=v.1X(4.P.p-1,b);7 c=4.P[b];4.2c=c.1W;4.Q=c.14;4.Z=c.1c;4.G=c.3T;4.1P=c.3Q||[1Q(4.Q/2,10),1Q(4.Z/2,10)];4.2l=c.3H||"3E";4.2i=c.3A||11;4.2h=c.3z||"2W";4.2g=c.3w||"3u";4.2A=c.3r||"3o";4.2U=c.3l||"5l,5h-5c";4.3j=c.54||"0 0"};J.6.3g=5(a){4.B=a};J.6.2V=5(b){7 a=[];9(!4.F.12){a.H(\'3e-4S:1W(\'+4.2c+\');\');a.H(\'3e-21:\'+4.3j+\';\')}9(1p 4.G===\'4P\'){9(1p 4.G[0]===\'3b\'&&4.G[0]>0&&4.G[0]<4.Q){a.H(\'14:\'+(4.Q-4.G[0])+\'A; 3a-1F:\'+4.G[0]+\'A;\')}E{a.H(\'14:\'+4.Q+\'A; 37-14:\'+4.Q+\'A;\')}9(1p 4.G[1]===\'3b\'&&4.G[1]>0&&4.G[1]<4.Z){a.H(\'1c:\'+(4.Z-4.G[1])+\'A; 3a-1M:\'+4.G[1]+\'A;\')}E{a.H(\'1c:\'+4.Z+\'A; 1d-35:1e;\')}}E{a.H(\'14:\'+4.Q+\'A; 37-14:\'+4.Q+\'A; 1c:\'+4.Z+\'A; 1d-35:1e;\')}a.H(\'4G:4E; 1F:\'+b.y+\'A; 1M:\'+b.x+\'A; 4C:\'+4.2l+\'; 21:2Q; 1I-1r:\'+4.2i+\'A; 1I-4z:\'+4.2U+\'; 1I-4y:\'+4.2g+\'; 1I-13:\'+4.2A+\'; 1d-4x:\'+4.2h+\';\');j a.4v("")};J.6.28=5(b){7 a=4.3d().22(b);a.x-=4.1P[1];a.y-=4.1P[0];j a};5 D(a){4.16=a;4.O=a.u();4.T=a.3h();4.Y=a.2R();4.1g=a.3k();4.12=a.3i();4.k=[];4.B=s;4.2b=s;4.18=I J(4,a.20())}D.6.41=5(){j 4.k.p};D.6.1D=5(){j 4.k};D.6.2O=5(){j 4.B};D.6.u=5(){j 4.O};D.6.17=5(){j 4.16};D.6.1y=5(){7 i;7 b=I n.o.1q(4.B,4.B);7 a=4.1D();w(i=0;i<a.p;i++){b.V(a[i].S())}j b};D.6.1C=5(){4.18.L(s);4.k=[];1Z 4.k};D.6.1B=5(e){7 i;7 c;7 b;9(4.2M(e)){j t}9(!4.B){4.B=e.S();4.1Y()}E{9(4.1g){7 l=4.k.p+1;7 a=(4.B.U()*(l-1)+e.S().U())/l;7 d=(4.B.19()*(l-1)+e.S().19())/l;4.B=I n.o.1o(a,d);4.1Y()}}e.1n=K;4.k.H(e);c=4.k.p;b=4.16.1w();9(b!==s&&4.O.1a()>b){9(e.u()!==4.O){e.L(4.O)}}E 9(c<4.Y){9(e.u()!==4.O){e.L(4.O)}}E 9(c===4.Y){w(i=0;i<c;i++){4.k[i].L(s)}}E{e.L(s)}4.2L();j K};D.6.2J=5(a){j 4.2b.34(a.S())};D.6.1Y=5(){7 a=I n.o.1q(4.B,4.B);4.2b=4.16.2e(a)};D.6.2L=5(){7 c=4.k.p;7 a=4.16.1w();9(a!==s&&4.O.1a()>a){4.18.1N();j}9(c<4.Y){4.18.1N();j}7 b=4.16.20().p;7 d=4.16.36()(4.k,b);4.18.3g(4.B);4.18.2I(d);4.18.27()};D.6.2M=5(a){7 i;9(4.k.1m){j 4.k.1m(a)!==-1}E{w(i=0;i<4.k.p;i++){9(a===4.k[i]){j K}}}j t};5 8(a,c,b){4.V(8,n.o.32);c=c||[];b=b||{};4.k=[];4.C=[];4.1s=[];4.1k=s;4.1t=t;4.T=b.3X||3W;4.Y=b.3V||2;4.1R=b.2z||s;4.P=b.3U||[];4.29=b.15||"";4.1K=K;9(b.2y!==1f){4.1K=b.2y}4.1g=t;9(b.2x!==1f){4.1g=b.2x}4.1b=t;9(b.2v!==1f){4.1b=b.2v}4.12=t;9(b.2u!==1f){4.12=b.2u}4.1A=b.3S||8.2s;4.1v=b.3R||8.2p;4.1u=b.3P||8.2o;4.1U=b.3J||8.2m;4.1S=b.3I||8.2k;4.1z=b.3G||8.2j;4.1T=b.3D||"N";9(3K.3L.3M().1m("3N")!==-1){4.1S=4.1z}4.2H();4.2w(c,K);4.L(a)}8.6.2E=5(){7 a=4;4.1k=4.u();4.1t=K;4.1h();4.1s=[n.o.z.1L(4.u(),"3y",5(){a.1x(t);9(4.1a()===(4.2q("3v")||0)||4.1a()===4.2q("2z")){n.o.z.W(4,"2t")}}),n.o.z.1L(4.u(),"2t",5(){a.1l()})]};8.6.2G=5(){7 i;w(i=0;i<4.k.p;i++){9(4.k[i].u()!==4.1k){4.k[i].L(4.1k)}}w(i=0;i<4.C.p;i++){4.C[i].1C()}4.C=[];w(i=0;i<4.1s.p;i++){n.o.z.3t(4.1s[i])}4.1s=[];4.1k=s;4.1t=t};8.6.3f=5(){};8.6.2H=5(){7 i,1r;9(4.P.p>0){j}w(i=0;i<4.1u.p;i++){1r=4.1u[i];4.P.H({1W:4.1A+(i+1)+"."+4.1v,14:1r,1c:1r})}};8.6.3s=5(){7 i;7 a=4.1D();7 b=I n.o.1q();w(i=0;i<a.p;i++){b.V(a[i].S())}4.u().1V(b)};8.6.3h=5(){j 4.T};8.6.3Z=5(a){4.T=a};8.6.2R=5(){j 4.Y};8.6.3q=5(a){4.Y=a};8.6.1w=5(){j 4.1R};8.6.3p=5(a){4.1R=a};8.6.20=5(){j 4.P};8.6.42=5(a){4.P=a};8.6.2K=5(){j 4.29};8.6.43=5(a){4.29=a};8.6.2C=5(){j 4.1K};8.6.3n=5(a){4.1K=a};8.6.3k=5(){j 4.1g};8.6.3m=5(a){4.1g=a};8.6.46=5(){j 4.1b};8.6.47=5(a){4.1b=a};8.6.5k=5(){j 4.1v};8.6.5i=5(a){4.1v=a};8.6.5g=5(){j 4.1A};8.6.5f=5(a){4.1A=a};8.6.5b=5(){j 4.1u};8.6.5a=5(a){4.1u=a};8.6.36=5(){j 4.1U};8.6.59=5(a){4.1U=a};8.6.3i=5(){j 4.12};8.6.57=5(a){4.12=a};8.6.51=5(){j 4.1z};8.6.50=5(a){4.1z=a};8.6.2r=5(){j 4.1T};8.6.4Z=5(a){4.1T=a};8.6.1D=5(){j 4.k};8.6.4X=5(){j 4.k.p};8.6.4V=5(){j 4.C};8.6.4U=5(){j 4.C.p};8.6.1B=5(b,a){4.2d(b);9(!a){4.1l()}};8.6.2w=5(b,a){7 i;w(i=0;i<b.p;i++){4.2d(b[i])}9(!a){4.1l()}};8.6.2d=5(b){9(b.4T()){7 a=4;n.o.z.1L(b,"4R",5(){9(a.1t){4.1n=t;a.1h()}})}b.1n=t;4.k.H(b)};8.6.4Q=5(c,a){7 b=4.26(c);9(!a&&b){4.1h()}j b};8.6.4O=5(a,c){7 i,r;7 b=t;w(i=0;i<a.p;i++){r=4.26(a[i]);b=b||r}9(!c&&b){4.1h()}j b};8.6.26=5(b){7 i;7 a=-1;9(4.k.1m){a=4.k.1m(b)}E{w(i=0;i<4.k.p;i++){9(b===4.k[i]){a=i;4N}}}9(a===-1){j t}b.L(s);4.k.4K(a,1);j K};8.6.4J=5(){4.1x(K);4.k=[]};8.6.1h=5(){7 a=4.C.4H();4.C=[];4.1x(t);4.1l();1O(5(){7 i;w(i=0;i<a.p;i++){a[i].1C()}},0)};8.6.2e=5(d){7 f=4.3d();7 c=I n.o.1o(d.23().U(),d.23().19());7 a=I n.o.1o(d.24().U(),d.24().19());7 e=f.22(c);e.x+=4.T;e.y-=4.T;7 g=f.22(a);g.x-=4.T;g.y+=4.T;7 b=f.2X(e);7 h=f.2X(g);d.V(b);d.V(h);j d};8.6.1l=5(){4.25(0)};8.6.1x=5(a){7 i,M;w(i=0;i<4.C.p;i++){4.C[i].1C()}4.C=[];w(i=0;i<4.k.p;i++){M=4.k[i];M.1n=t;9(a){M.L(s)}}};8.6.33=5(b,e){7 R=4D;7 g=(e.U()-b.U())*v.1H/1G;7 f=(e.19()-b.19())*v.1H/1G;7 a=v.1J(g/2)*v.1J(g/2)+v.31(b.U()*v.1H/1G)*v.31(e.U()*v.1H/1G)*v.1J(f/2)*v.1J(f/2);7 c=2*v.4B(v.30(a),v.30(1-a));7 d=R*c;j d};8.6.2Z=5(b,a){j a.34(b.S())};8.6.39=5(c){7 i,d,N,1e;7 a=4L;7 b=s;w(i=0;i<4.C.p;i++){N=4.C[i];1e=N.2O();9(1e){d=4.33(1e,c.S());9(d<a){a=d;b=N}}}9(b&&b.2J(c)){b.1B(c)}E{N=I D(4);N.1B(c);4.C.H(N)}};8.6.25=5(e){7 i,M;7 d;7 c=4;9(!4.1t){j}9(e===0){n.o.z.W(4,"4M",4);9(1p 4.1i!=="1f"){4w(4.1i);1Z 4.1i}}9(4.u().1a()>3){d=I n.o.1q(4.u().1y().24(),4.u().1y().23())}E{d=I n.o.1q(I n.o.1o(3c.4u,-2Y.4t),I n.o.1o(-3c.4s,2Y.4q))}7 a=4.2e(d);7 b=v.1X(e+4.1S,4.k.p);w(i=e;i<b;i++){M=4.k[i];9(!M.1n&&4.2Z(M,a)){9(!4.1b||(4.1b&&M.4W())){4.39(M)}}}9(b<4.k.p){4.1i=1O(5(){c.25(b)},0)}E{1Z 4.1i;n.o.z.W(4,"4p",4)}};8.6.V=5(d,c){j(5(b){7 a;w(a 4Y b.6){4.6[a]=b.6[a]}j 4}).4o(d,[c])};8.2m=5(a,c){7 f=0;7 b="";7 d=a.p.4n();7 e=d;4m(e!==0){e=1Q(e/10,10);f++}f=v.1X(f,c);j{1d:d,2D:f,15:b}};8.2k=52;8.2j=4l;8.2s="4k://n-o-4j-58-4h.4g.4f/4e/4c/5e/4b/m";8.2p="49";8.2o=[53,56,5j,48,45];',
62,333,"    this function prototype var MarkerClusterer if          return markers_   google maps length div_  null false getMap Math for   event px center_ clusters_ Cluster else cluster_ anchor_ push new ClusterIcon true setMap marker cluster map_ styles_ height_  getPosition gridSize_ lat extend trigger sums_ minClusterSize_ width_   printable_ style height title markerClusterer_ getMarkerClusterer clusterIcon_ lng getZoom ignoreHidden_ width text center undefined averageCenter_ repaint timerRefStatic visible_ activeMap_ redraw_ indexOf isAdded LatLng typeof LatLngBounds size listeners_ ready_ imageSizes_ imageExtension_ getMaxZoom resetViewport_ getBounds batchSizeIE_ imagePath_ addMarker remove getMarkers addDomListener top 180 PI font sin zoomOnClick_ addListener left hide setTimeout anchorIcon_ parseInt maxZoom_ batchSize_ clusterClass_ calculator_ fitBounds url min calculateBounds_ delete getStyles position fromLatLngToDivPixel getNorthEast getSouthWest createClusters_ removeMarker_ show getPosFromLatLng_ title_ div bounds_ url_ pushMarkerTo_ getExtendedBounds mouseover fontWeight_ textDecoration_ textSize_ BATCH_SIZE_IE BATCH_SIZE textColor_ CALCULATOR stopPropagation IMAGE_SIZES IMAGE_EXTENSION get getClusterClass IMAGE_PATH idle printable ignoreHidden addMarkers averageCenter zoomOnClick maxZoom fontStyle_ mouseout getZoomOnClick index onAdd className_ onRemove setupStyles_ useStyle isMarkerInClusterBounds getTitle updateIcon_ isMarkerAlreadyAdded_ click getCenter 0px absolute getMinimumClusterSize innerHTML parentNode fontFamily_ createCss none fromDivPixelToLatLng 178 isMarkerInBounds_ sqrt cos OverlayView distanceBetweenPoints_ contains align getCalculator line display addToClosestCluster_ padding number 85 getProjection background draw setCenter getGridSize getPrintable backgroundPosition_ getAverageCenter fontFamily setAverageCenter setZoomOnClick normal setMaxZoom setMinimumClusterSize fontStyle fitMapToMarkers removeListener bold minZoom fontWeight createElement zoom_changed textDecoration textSize cancelBubble document clusterClass black 100 batchSizeIE textColor batchSize calculator navigator userAgent toLowerCase msie setZoom imageSizes anchorIcon imageExtension imagePath anchor styles minimumClusterSize 60 gridSize max setGridSize clusterclick getSize setStyles setTitle mousedown 90 getIgnoreHidden setIgnoreHidden 78 png src images trunk img svn com googlecode v3 bounds_changed utility http 500 while toString apply clusteringend 00048865625 cssText 08136444384544 48388434375 02070771743472 join clearTimeout decoration weight family appendChild atan2 color 6371 pointer overlayMouseTarget cursor slice getPanes clearMarkers splice 40000 clusteringbegin break removeMarkers object removeMarker dragend image getDraggable getTotalClusters getClusters getVisible getTotalMarkers in setClusterClass setBatchSizeIE getBatchSizeIE 2000  backgroundPosition removeChild  setPrintable library setCalculator setImageSizes getImageSizes serif clearInstanceListeners markerclustererplus setImagePath getImagePath sans setImageExtension 66 getImageExtension Arial className".split(" "),
0,{}));var Lat2Km=111.03461,Km2Lat=0.009006,Lon2Km=85.39383,Km2Lon=0.01171,LL2Km=98.2,Km2LL=0.010183,FUEL_OPTIONS={1:{"short":"G95",name:"Gasolina 95"},3:{"short":"G98",name:"Gasolina 98"},4:{"short":"GOA",name:"Gas\u00f3leo Automoci\u00f3n"},5:{"short":"NGO",name:"Nuevo Gas\u00f3leo A"},6:{"short":"GOB",name:"Gas\u00f3leo B"},7:{"short":"GOC",name:"Gas\u00f3leo C"},8:{"short":"BIOD",name:"Biodi\u00e9sel"}},CHART_OPTIONS=[{id:"G98",color:"#339933",name:"Gasolina 98"},{id:"G95",color:"#006633",name:"Gasolina 95"},
{id:"NGO",color:"#aaa",name:"Nuevo Gas\u00f3leo A"},{id:"BIOD",color:"#f1aa41",name:"Biodi\u00e9sel"},{id:"GOA",color:"#000",name:"Gas\u00f3leo Automoci\u00f3n"},{id:"GOC",color:"#FF3300",name:"Gas\u00f3leo C"},{id:"GOB",color:"#CC3333",name:"Gas\u00f3leo B"}],PROVS={"\u00c1lava":"01",Albacete:"02",Alicante:"03","Almer\u00eda":"04",Asturias:"33","\u00c1vila":"05",Badajoz:"06","Balears (Illes)":"07",Barcelona:"08",Burgos:"09","C\u00e1ceres":"10","C\u00e1diz":"11",Cantabria:"39","Castell\u00f3n / Castell\u00f3":"12",
Ceuta:"51","Ciudad Real":"13","C\u00f3rdoba":"14","Coru\u00f1a (A)":"15",Cuenca:"16",Girona:"17",Granada:"18",Guadalajara:"19","Guip\u00fazcoa":"20",Huelva:"21",Huesca:"22","Ja\u00e9n":"23","Le\u00f3n":"24",Lleida:"25",Lugo:"27",Madrid:"28","M\u00e1laga":"29",Melilla:"52",Murcia:"30",Navarra:"31",Ourense:"32",Palencia:"34","Palmas (Las)":"35",Pontevedra:"36","Rioja (La)":"26",Salamanca:"37","Santa Cruz De Tenerife":"38",Segovia:"40",Sevilla:"41",Soria:"42",Tarragona:"43",Teruel:"44",Toledo:"45","Valencia / Val\u00e8ncia":"46",
Valladolid:"47",Vizcaya:"48",Zamora:"49",Zaragoza:"50"},MONTHS="Enero Febrero Marzo Abril Mayo Junio Julio Agosto Septiembre Octubre Noviembre Diciembre".split(" "),COLORS={stroke:"#fff",min:"#36AE34",max:"#f00",mu:"#3399CC"},LS_EXPIRE=36E5;function addEvent(a,e,b){a.addEventListener?a.addEventListener(e,b,!1):a.attachEvent&&a.attachEvent("on"+e,b)}
function getAllElementsByClassName(a,e){if(document.getElementsByClassName)return a.getElementsByClassName(e);e=e.replace(/ *$/,"");if(document.querySelectorAll)return a.querySelectorAll((" "+e).replace(/ +/g,"."))}function lockScroll(a){"string"==typeof a&&(a=document.getElementById(a));addEvent(a,"mouseover",function(){document.body.style.overflow="hidden"});addEvent(a,"mouseout",function(){document.body.style.overflow="auto"})}
function initProvLinks(a,e){var b=document.getElementById(a),c;for(c in PROVS){var d=document.createElement("li");d.id="plist-"+PROVS[c];if(e)d.textContent=c,d.onclick=e;else{var f=document.createElement("a");f.title="Todas las gasolineras de "+c;f.textContent=c;f.href="/gasolineras/"+encodeName(c);d.appendChild(f)}b.appendChild(d)}lockScroll(b)}function getProvName(a){for(k in PROVS)if(PROVS[k]==a)return k}function clearHtmlTags(a){return a.replace(/(<([^>]+)>)/ig,"")}
function toTitle(a){return a.replace(" [N]","").replace(/^CARRETERA ?|^CR\.? ?/i,"CTRA. ").replace(/(CTRA. )+/i,"CTRA. ").replace(/^AVENIDA ?|^AV. ?/i,"AVDA. ").replace(/^POLIGONO INDUSTRIAL ?|POLIGONO ?|P\.I\. ?/i,"POL. IND. ").replace(/^CALLE |^CL\.? ?|C\/ ?/i,"C/ ").replace(/^RONDA |^RD /i,"RDA. ").replace(/^AUTOPISTA (AUTOPISTA ?)?/i,"AU. ").replace(/^PLAZA ?/i,"PL. ").replace(/^PASEO (PASEO ?)?/i,"P\u00ba ").replace(/^TRAVESS?[I\u00cd]A /i,"TRAV. ").replace(/^V[i\u00ed]A (V[I\u00cd]A )?/i,"V\u00cdA ").replace(/\B[^\d- ]+[ $]/g,
function(a){return a.toLowerCase()}).replace(/\b[NAE]-.+\b/,function(a){return a.toUpperCase()}).replace(/\[D\]$/,"(m.d.)").replace(/\[I\]$/,"(m.i.)").replace(/ \[N\]$/,"")}
function getLogo(a){return a&&(a=a.replace(/camspa/i,"campsa"),a=a.match(/\b(abycer|agla|alcampo|andamur|a\.?n\.? energeticos|avia|bonarea|b\.?p\.?|buquerin|campsa|carmoned|carrefour|cepsa|empresoil|eroski|esclatoil|galp|gasolben|iberdoex|leclerc|makro|meroil|norpetrol|petrem|petrocat|petromiralles|petronor|ramell|repostar|repsol|saras|shell|simply|staroil|tamoil|valcarce)\b/i))?a[0].replace(/\./g,"").replace(/ /g,"_").toLowerCase():null}
function decodeName(a){return decodeURI(a).replace(/_/g," ").replace(/\|/g,"/")}function decodeArray(a){for(var e=0;e<a.length;e++)a[e]=decodeName(a[e]);return a}function encodeName(a){return encodeURI(a.replace(/\//g,"|").replace(/ /g,"_"))}function prettyName(a){a.match("/")&&(a=a.split("/")[1]);a.match(/\)$/)&&(a=a.match(/\(.+\)$/g)[0].replace("(","").replace(")"," ")+a.split(" (")[0]);return a}
function checkLocalStorage(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}}function getKey(){return window.location.pathname.split("/").slice(1).join("*")}
function getApiData(a,e,b){"undefined"==typeof b&&(b=!1);var c=a+"*"+getKey(),d=(new Date).getTime();if(checkLocalStorage()){var f=localStorage[c];if(f)if(f=JSON.parse(f),d-f.ts>LS_EXPIRE||b)localStorage.removeItem(c);else{e(f.data);return}}b=new XMLHttpRequest;b.onreadystatechange=function(a){4==this.readyState&&200==this.status&&(a=JSON.parse(this.responseText),checkLocalStorage()&&localStorage.setItem(c,JSON.stringify({ts:d,data:a})),e(a))};f="api/";"history"==a?f+="h":"comments"==a&&(f+="c");
a=window.location.pathname.split("/")[1];b.open("GET",document.URL.replace(a,f));b.send()}function distance(a,e,b){var c=Math.abs(a[0]-e[0])*Lat2Km;return c<b&&(a=Math.abs(a[1]-e[1])*Lon2Km,a<b&&(c=Math.sqrt(c*c+a*a),c<b))?c:!1}
function distanceOrto(a,e,b,c){var d=[b[0]-e[0],b[1]-e[1]],f=[a[0]-e[0],a[1]-e[1]],f=(f[0]*d[0]+f[1]+d[1])/(d[0]*d[0]+d[1]*d[1]);if(0>=f)return distance(a,e,c);if(1<=f)return distance(a,b,c);a=[(e[0]+f*d[0]-a[0])*Lat2Km,(e[1]+f*d[1]-a[1])*Lon2Km];return Math.sqrt(a[0]*a[0]+a[1]*a[1])<c}
function SearchLocations(){this.locs=[];this.radius=2;this.length=function(){return this.locs.length};this.add=function(a,e){this.locs.push({name:a,latlng:e})};this.latlng=function(){return 1==this.length()?this.locs[0].latlng:null};this.name=function(){return 1==this.length()?this.locs[0].name:null};this.get=function(a){return this.locs[a]};this.select=function(a){this.locs=[this.locs[a]]};this.clear=function(){this.locs=[]}}
function Stats(){this.n=0;this.max=this.min=this.mu=this.range=null;this.smin=[];this.smax=[];this.g=null;this.range=function(){null==this.range&&(this.range=this.max-this.min);return this.range};this.add=function(a,e,b){this.mu?(a>this.max?(this.max=a,this.smax=[e]):a==this.max?this.smax.push(e):a<this.min?(this.min=a,this.smin=[e]):a==this.min&&this.smin.push(e),this.mu=(this.mu*this.n+a)/++this.n):(this.max=this.min=this.mu=a,this.smin=[e],this.smax=[e],this.n=1);b&&(this.g?(b[0]<this.g[0]?this.g[0]=
b[0]:b[0]>this.g[1]&&(this.g[1]=b[0]),b[1]<this.g[2]?this.g[2]=b[1]:b[1]>this.g[3]&&(this.g[3]=b[1])):this.g=[b[0],b[0],b[1],b[1]])}}
function GasoleStats(a,e){function b(a,c,b,e){c[e]||(c[e]=new Stats);b[e]||(b[e]=new Stats);c[e].add(a.o[e],[d,h,p],a.g);b[e].add(a.o[e],[d,h,p],a.g)}var c=this.stats={};this.provinces={};for(var d in a){var f=a[d],g=this.provinces[d]={},h;for(h in f){var l=f[h],p;for(p in l)if(datas=l[p],e)for(var m=e.length-1;0<=m;m--){var n=e[m];datas.o[n]&&b(datas,g,c,n)}else for(n in datas.o)b(datas,g,c,n)}}}
function Gasole(a){this.color=function(a){var b=this.stats.range();if(0!=b){a=(a-this.stats.min)/b;if(0.33>a)return COLORS.min;if(0.66<a)return COLORS.max}return COLORS.mu};this.init=function(a,b,c){this.info=a;this.date=b;this.stats=c?c:new GasoleStats(this.info)};this.provinceDataArray=function(a){this.stats=new Stats;var b=this.type;result=[];a=this.info[a];for(var c in a){var d=a[c],f;for(f in d){var g=d[f],h=g.o[b];h&&(result.push({a:f,r:g.r,g:g.g,p:h,t:c,l:g.l,d:null}),this.stats.add(h))}}return result};
this.nearData=function(a){var b=a.latlng();if(b){a=a.radius;var c={},d;for(d in this.info){var f=this.info[d];c[d]={};for(var g in f){var h=f[g];c[d][g]={};for(var l in h){var p=h[l],m=p.g;m&&distance(m,b,a)&&(c[d][g][l]=p)}Object.keys(c[d][g]).length||delete c[d][g]}Object.keys(c[d]).length||delete c[d]}return c}};this.nearDataArray=function(a,b,c){var d=a.latlng();if(d){a=a.radius;this.stats=new Stats;var f=[],g;for(g in this.info){var h=this.info[g],l;for(l in h){var p=h[l],m;for(m in p){var n=
p[m];if(n.o.hasOwnProperty(b)){var q=n.g;if(q){var u=distance(q,d,a);if(u){var r=n.o[b];f.push({a:m,prov:g,g:q,p:r,t:l,l:n.l,d:u});this.stats.add(r)}}}}}}return c?f.sort(function(a,b){return a[c]<b[c]?-1:1}):f}};this.routeData=function(a){var b={};gasoleProcess(this.info,function(c,d,f,g){var h=c.g;if(h)for(var l=0,p=a.length-1;l<p;l++){var m=a[l],n=a[l+1];distanceOrto(h,[m.lat(),m.lng()],[n.lat(),n.lng()],1)&&((m=b[d])||(m=b[d]={}),(n=m[f])||(n=m[f]={}),n[g]=c)}});return b};this.callback=a;this.date=
this.info=this.stats=null;this.type="1";a=null;checkLocalStorage()&&(a=localStorage.gasole)&&(a=JSON.parse(a));!a||(new Date).getTime()-parseInt(a.ts)>LS_EXPIRE?(a=new XMLHttpRequest,a.gasole=this,a.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var a=null,b=JSON.parse(this.responseText);b._meta?(a=new Date(b._meta.ts),b=b._data):a=new Date;this.gasole.init(b,a);checkLocalStorage()&&(a={ts:a.getTime(),data:b,stats:this.gasole.stats},localStorage.setItem("gasole",JSON.stringify(a)));
this.gasole.callback&&this.gasole.callback()}},a.open("GET","/api/gasole"),a.send()):(this.init(a.data,new Date(a.ts),a.stats),this.callback&&this.callback())}function fillPriceDigits(a,e){a.innerHTML="";for(var b=e.toFixed(3),c=0;c<b.length;c++){var d=document.createElement("div");d.className="back";"."==b[c]?d.className+=" point":d.textContent=8;var f=document.createElement("div");f.className="digit";f.textContent=b[c];d.appendChild(f);a.appendChild(d)}}
function gasoleProcess(a,e){for(var b in a){var c=a[b],d;for(d in c){var f=c[d],g;for(g in f)e(f[g],b,d,g)}}}function stopEvent(a){a.cancelBubble=!0;a.returnValue=!1;a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();return!1}
function sortName(a,e){function b(a){a=a.toLowerCase();a=a.replace(RegExp(/\s/g),"");a=a.replace(RegExp(/[\u00e0\u00e1]/g),"a");a=a.replace(RegExp(/[\u00e8\u00e9]/g),"e");a=a.replace(RegExp(/[\u00ec\u00ed]/g),"i");a=a.replace(RegExp(/[\u00f2\u00f3]/g),"o");return a=a.replace(RegExp(/[\u00f9\u00fa]/g),"u")}return b(a)<b(e)?-1:1}
function formatUpdate(a){var e;e="Precios actualizados el "+(a.getDate()+" de "+MONTHS[a.getMonth()]);return e+=" a las "+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)}Array.prototype.filter||(Array.prototype.filter=function(a,e){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],f=0;f<c;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d});var TIME;function tic(){TIME=(new Date).getTime()}
function toc(a){console.log((a?a+" :":"Transcurridos: ")+((new Date).getTime()-TIME)+" ms")}
function breadCrumb(a,e){var b=document.getElementById(a);if(b){b.innerHTML="<a href='/' class='bc'>Gasolineras</a><span class='sprt breadcrumb'>&nbsp;</span>";var c=window.location.pathname.split("/"),d=document.createElement("a");d.className="bc";if("resultados"==c[1])d.textContent="Cerca de "+decodeURI(c[2]),d.href="#",b.appendChild(d);else if("ruta"==c[1])d.textContent="Ruta entre "+decodeURI(c[2])+" y"+decodeURI(c[3]),d.href="#",d.title=d.textContent,b.appendChild(d);else{var f=decodeName(c[2]);
d.textContent=f;d.title="Ver todas las gasolineras en la provincia de "+f;var g="/gasolineras/"+c[2];d.href=g;b.appendChild(d);c[3]&&(b.innerHTML+="<span class='sprt breadcrumb'>&nbsp;</span>",d=document.createElement("a"),d.className="bc",f=decodeName(c[3]),d.textContent=f,d.title="Ver todas las gasolineras en la localidad de "+f,d.href=g+"/"+c[3],b.appendChild(d));c[4]&&(b.innerHTML+="<span class='sprt breadcrumb'>&nbsp;</span>",d=document.createElement("a"),d.className="bc",d.textContent="Gasolinera "+
(e?e:"")+" en "+toTitle(decodeName(c[4])),d.href=window.location.pathname,b.appendChild(d))}}};var gasoleData,map,place=null,markers=[],markerCenter=null,markerDetail=null,pagerCurrent=null,cluster=null,bounds=new google.maps.LatLngBounds,TO_DAYS=864E5,stats=null,MARKER_IMG={max:new google.maps.MarkerImage("/img/sprt.png",new google.maps.Size(25,25,"px","px"),new google.maps.Point(29,539),null,null),min:new google.maps.MarkerImage("/img/sprt.png",new google.maps.Size(25,25,"px","px"),new google.maps.Point(2,539),null,null),mu:new google.maps.MarkerImage("/img/sprt.png",new google.maps.Size(25,
25,"px","px"),new google.maps.Point(2,566),null,null)};function computeWeights(a){var e=0,b;for(b in a)e+=a[b].n;for(b in a)a[b].w=a[b].n/e}
function newReference(a){function e(a,c){bounds.extend(a);map.fitBounds(bounds);markerCenter?markerCenter.setPosition(a):markerCenter=new google.maps.Marker({map:map,position:a,icon:"/img/center_mark.png"});calcDistances();var e=document.getElementById("table-data").getElementsByTagName("tr")[0];b.innerHTML=e?"La gasolinera m\u00e1s pr\u00f3xima en l\u00ednera recta a "+c+" se encuentra en "+getAllElementsByClassName(e,"T_ADDR")[0].textContent:"No se ha encontrado ninguna gasolinera.";markerCenter.setAnimation(google.maps.Animation.DROP)}
var b=document.getElementById("distance-info");if("undefined"==typeof a)a=document.getElementById("from").value,(new google.maps.Geocoder).geocode({address:a},function(a,c){c==google.maps.GeocoderStatus.OK?e(a[0].geometry.location,a[0].formatted_address):b.innerHTML="No se ha podido encontrar el lugar."});else{var c=a.latlng();e(new google.maps.LatLng(c[0],c[1]),a.name())}}
function paginateTable(a){var e=getAllElementsByClassName(document.getElementById("table-data"),"r_on"),b=e.length,c=document.getElementById("no-results"),d=document.getElementById("pager"),f=document.getElementById("pager-links");if(0!=b){if(c.style.display="none",d.style.display="block","more"===a?a=Math.min(pagerCurrent+12,12*parseInt(b/12)):"less"===a&&(a=Math.max(pagerCurrent-12,0)),!(a>=b)){f.innerHTML="";for(c=0;c<b;c++)if(e[c].style.display=c<a||c>=a+12?"none":"",0==c%12){var g=document.createElement("div");
g.innerHTML=c+1+"<br/>"+Math.min(c+12,b);g.setAttribute("onclick","javascript:paginateTable("+c+");");c==a?g.className="p current":g.className="p";f.appendChild(g)}pagerCurrent=a;d.style.display=12>=b?"none":"block"}}else c.style.display="block",d.style.display="none"}
function calcDistances(){for(var a=getAllElementsByClassName(document.getElementById("table-data"),"T_DIST"),e=0,b=a.length;e<b;e++){var c=a[e].getAttribute("data-geo");if(c){var c=c.split(","),d=(parseFloat(c[0])-markerCenter.position.lat())*Lat2Km,c=(parseFloat(c[1])-markerCenter.position.lng())*Lon2Km;a[e].textContent=Math.sqrt(d*d+c*c).toFixed(1)}}sortTable("T_DIST",!1)}
function markerColor(a,e){for(var b=0,c=0,d=0;d<a.length;d++){var f=a[d],g=e[f];if((f=stats[f])&&g)var h=f.max-f.min,b=h?(b*c+(g-f.min)/h)/++c:b*c+0.5/++c}return 0==c?null:0.33>b?COLORS.min:0.66>b?COLORS.mu:COLORS.max}
function updateMarkers(){for(var a=document.getElementById("table-data").getElementsByTagName("tr"),e=getSelTypes(),b,c,d=0,f=a.length;d<f;d++)if(c=a[d],b=markers[c.id.split("-")[1]])if(c.className.match("r_on")){c=b;for(var g=b.get("price"),h=0,l=0,p=0;p<e.length;p++){var m=e[p],n=g[m];if((m=stats[m])&&n)var q=m.max-m.min,h=q?(h*l+(n-m.min)/q)/++l:h*l+0.5/++l}c.icon=0==l?null:0.33>h?MARKER_IMG.min:0.66>h?MARKER_IMG.mu:MARKER_IMG.max;b.setMap(map)}else b.setMap(null)}
function sortTable(a,e){"undefined"==typeof e&&(e=!1);for(var b=!("T_LOC"==a||"T_ADDR"==a),c=document.getElementById("table-data"),d=getAllElementsByClassName(c,a),f=[],g,h=0,l=d.length;h<l;h++)(g=d[h].textContent)&&f.push([b?parseFloat(g):g,h]);f.sort(function(a,b){a=a[0];b=b[0];return a<b?-1:b<a?1:0});e&&f.reverse();d=c.getElementsByTagName("tr");b=[];g=0;for(h=d.length;g<h;g++)b.push(d[g]);for(d=f.length-1;0<=d;d--)c.insertBefore(b[f[d][1]],c.children[0]);c=document.getElementById("table").getElementsByTagName("th");
f=0;for(b=c.length;f<b;f++)c[f].className=c[f].className.replace(" sort_up","").replace(" sort_down",""),c[f].className.match(a)&&(c[f].className+=e?" sort_down":" sort_up");paginateTable(0)}
function filterTypes(a){for(var e=0,b=a.length;e<b;e++)for(var c=a[e].split(" "),d=c[0],f=d+" off",g=d+" on",h=d,d=getAllElementsByClassName(document.getElementById("table"),d),l="off"==c[1],p=0,m=d.length;p<m;p++)c=d[p],c.className=l?f:c.textContent?g:h;var n;gasoleProcess(gasoleData._data,function(a){n=a.row;n.className=getAllElementsByClassName(n,"on").length?"r_on":"r_off"})}
function filterText(){function a(a){return a.toLowerCase().replace(/\s+/g," ").replace(/\s$/,"").replace(/^\s/,"").replace(/[\u00b4,.;]/g,"").replace(/[\u00e1\u00e0\u00e4]/g,"a").replace(/[\u00e9\u00e8\u00eb]/g,"e").replace(/[\u00ed\u00ec\u00ef]/g,"i").replace(/[\u00f3\u00f2\u00f6]/g,"o").replace(/[\u00fa\u00f9\u00fc]/g,"u")}var e=a(document.getElementById("contains").value);if(e.length){var b=e.split(/\s/),c=b.length;gasoleProcess(gasoleData._data,function(d,e,g,h){e=d.row;if("r_off"!=e.className){d=
a(g+" "+h+" "+d.l);for(g=0;g<c;g++)if(null!=RegExp(b[g]).exec(d))e.className="r_on";else{e.className="f_off";break}}})}else gasoleProcess(gasoleData._data,function(a){a=a.row;"r_off"!=a.className&&(a.className="r_on")})}
function initControl(){document.getElementById("cluster").onclick=function(){if(document.getElementById("cluster").checked)for(var a=0,b=markers.length;a<b;a++)markers[a].getMap()&&cluster.addMarker(markers[a]);else cluster.clearMarkers(),updateMarkers()};for(var a=document.getElementById("fuel-type").getElementsByTagName("li"),e=[],b=0;b<a.length;b++)if(stats[a[b].className.split(" ")[0].split("_")[1]]){var c=a[b];e.push(c.className);c.onclick=function(a){return function(){var b=a.className.split(" "),
b=b[0]+" "+("on"==b[1]?"off":"on");a.className=b;filterTypes([b]);filterText();paginateTable(0);updateMarkers()}}(c)}else e.push(a[b].className.replace("on","off")),a[b].className="disabled";filterTypes(e);addEvent(document.getElementById("contains"),"input",function(){filterText();paginateTable(0);updateMarkers()});a=document.getElementById("table").getElementsByTagName("th");for(e=0;e<a.length;e++)addEvent(a[e],"click",function(){sortTable(this.className.match(/T_\w+/)[0],null!=this.className.match("sort_up"))});
lockScroll("cities-list")}
function showDetail(a){function e(){document.getElementById("detail").className="";markerDetail.setAnimation(null)}document.getElementById("cluster").checked=!1;document.getElementById("cluster").onclick();google.maps.event.addListenerOnce(map,"mousedown",e);document.getElementById("d-close").onclick=e;markerDetail&&markerDetail.setAnimation(null);markerDetail=a;map.panTo(a.position);a.setAnimation(google.maps.Animation.BOUNCE);document.getElementById("detail").className="on";a=document.getElementById(a.get("id"));
var b=a.getElementsByClassName("T_ADDR")[0].getAttribute("label"),c=a.getElementsByClassName("T_ADDR")[0].getElementsByTagName("a")[0].textContent,d=a.getElementsByClassName("T_ADDR")[0].getElementsByTagName("a")[0].href,f=a.getElementsByClassName("T_LOC")[0].textContent;document.getElementById("d-title").textContent="Gasolinera "+b+" en "+f+", "+c;document.getElementById("d-link").href=d;b=document.getElementById("d-prices");b.innerHTML="";c=a.getElementsByTagName("td");d=4;for(f=c.length;d<f;d++){var g=
c[d].textContent;if(g){var h=c[d].className.match(/T_\w+/)[0].replace("T_",""),l=document.createElement("li");l.className="T_"+h;l.innerHTML="<div>"+FUEL_OPTIONS[h].name+"</div><div class='p'>"+g+"</div>";b.appendChild(l)}}b=document.getElementById("d-date");c=document.getElementById("d-clock");a=(new Date-new Date(parseInt(a.getElementsByClassName("T_DATE")[0].textContent)))/TO_DAYS;d="";f="sprt clock";1>a?(d=" hoy",f+="_new"):(d=" hace "+Math.floor(a)+" d\u00eda"+(2<a?"s":""),f+=7>=a?"_med":"_old");
b.innerHTML="Precios actualizados<br>"+d;c.className=f}function getSelTypes(){for(var a=[],e=getAllElementsByClassName(document.getElementById("types"),"on"),b=0;b<e.length;b++)a.push(parseInt(e[b].className.split(" ")[0].split("_")[1]));return a}
function processData(a){function e(a){var c,d=a.getElementsByTagName("tr"),e=d.length;for(c=0;c<e;c++)a.removeElement(d[c])}(function(a){var c=document.getElementById("table-data"),d=[],f=new Date,g,h,l,p,m;e(c);for(var n in a){g=a[n];p=encodeName(n);for(var q in g){h=g[q];l=encodeName(q);m="/gasolineras/"+p+"/"+l;s_link="/ficha/"+p+"/"+l+"/";d.push([q,m]);for(var u in h){l=h[u];var r=l.l,w=document.createElement("tr");w.className="r_on";var s=document.createElement("td"),t=document.createElement("a");
t.href=m;t.title="Todas las gasolineras de "+q;t.textContent=q;s.className="T_LOC";s.appendChild(t);w.appendChild(s);s=document.createElement("td");t=document.createElement("a");t.href=s_link+encodeName(u);t.textContent=toTitle(u);t.title="Ficha de la gasolinera "+r+" en "+q+", "+t.textContent;s.className="T_ADDR";s.setAttribute("label",r);var v=document.createElement("div");v.className="ref";var x=document.createElement("div");x.className="logo "+(getLogo(r)||"otra");v.appendChild(x);v.appendChild(t);
s.appendChild(v);w.appendChild(s);r=document.createElement("td");r.className="T_DIST";if(s=l.g)t=new google.maps.LatLng(s[0],s[1]),v=new google.maps.Marker({icon:null,map:map,position:t}),google.maps.event.addListener(v,"click",function(a){showDetail(this)}),v.set("price",l.o),w.id="tr-"+markers.length,r.id="td-"+markers.length,markers.push(v),r.setAttribute("data-geo",s.join(",")),addEvent(r,"click",function(){var a=markers[this.id.split("-")[1]];showDetail(a)}),v.set("id",w.id),bounds.extend(t);
w.appendChild(r);r=document.createElement("td");r.className="T_DATE";s=document.createElement("div");t=new Date(l.d);v=(f-t)/TO_DAYS;s.className="sprt clock";s.className=1>v?s.className+"_new":7<v?s.className+"_old":s.className+"_med";r.title=t.toLocaleDateString();r.innerHTML="<span>"+t.getTime()+"</span>";r.appendChild(s);w.appendChild(r);for(var y in FUEL_OPTIONS){otd=document.createElement("td");otd.className="T_"+y;if(r=l.o[y])otd.textContent=r.toFixed(3),otd.className+=" on";w.appendChild(otd)}c.appendChild(w);
l.row=w}}}map.fitBounds(bounds);a=d.length;if(1<a){c=document.getElementById("cities-list");d.sort(function(a,b){return sortName(a[0],b[0])});for(g=0;g<a;g++)f=d[g],c.innerHTML+="<li><a href='"+f[1]+"'>"+f[0]+"</a></li>"}else document.getElementById("p-cities").style.display="none"})(a._data);(function(){document.getElementById("info");var a=document.getElementById("summary-b"),c;for(c in stats){var d=stats[c],e=document.createElement("tr");e.className="data T_"+c;var g=document.createElement("td");
g.textContent=FUEL_OPTIONS[c].name;e.appendChild(g);g=document.createElement("td");g.textContent=d.n;e.appendChild(g);g=document.createElement("td");g.innerHTML="<span>"+d.min.toFixed(3)+"</span>";g.className="price min";e.appendChild(g);g=document.createElement("td");g.innerHTML="<span>"+d.mu.toFixed(3)+"</span>";g.className="price mean";e.appendChild(g);g=document.createElement("td");g.innerHTML="<span>"+d.max.toFixed(3)+"</span>";g.className="price max";e.appendChild(g);a.appendChild(e)}})();initControl();
updateMarkers();place||(place=new SearchLocations,a=bounds.getCenter(),place.add("la posici\u00f3n del marcador azul",[a.lat(),a.lng()]));newReference(place)}
addEvent(window,"load",function(){breadCrumb("breadcrumb");(function(){map=new google.maps.Map(document.getElementById("google_map"),{mapTypeId:google.maps.MapTypeId.ROADMAP});cluster=new MarkerClusterer(map,null,{imagePath:"/",styles:[{height:40,width:40,url:"/img/cluster.png",backgroundPosition:"-2px -2px"},{height:50,width:50,url:"/img/cluster.png",backgroundPosition:"-44px -2px"},{height:60,width:60,url:"/img/cluster.png",backgroundPosition:"-2px -54px"},{height:70,width:70,url:"/img/cluster.png",
backgroundPosition:"-2px -116px"}]});if(!window.location.hostname.match("localhost")){var a=document.createElement("div");adUnit=new google.maps.adsense.AdUnit(a,{format:google.maps.adsense.AdFormat.VERTICAL_BANNER,position:google.maps.ControlPosition.RIGHT_TOP,backgroundColor:"#c4d4f3",borderColor:"#e5ecf9",titleColor:"#0000cc",textColor:"#000000",urlColor:"#009900",map:map,visible:!0,publisherId:"pub-9285487390483271"})}})();new Gasole(function(){gasoleData={_data:{}};var a=decodeArray(window.location.pathname.split("/")),
e=a[1],b=document.getElementById("title");if("gasolineras"==e){e=a[2];if(a[3]){var c=a[3];gasoleData._data[e]={};gasoleData._data[e][c]=this.info[e][c]}else gasoleData._data[e]=this.info[e];b.textContent="Gasolineras en "+(c?prettyName(c)+", ":"la ")+"provincia de "+prettyName(e)}else if("resultados"==e)place=new SearchLocations,place.add(decodeURIComponent(a[2]),[parseFloat(a[3]),parseFloat(a[4])]),place.radius=parseFloat(a[5]),gasoleData._data=this.nearData(place),gasoleData._near=place,b.textContent=
"Gasolineras cerca de: "+place.name();else if("ruta"==e){var d=new google.maps.DirectionsRenderer({draggable:!1});d.setMap(map);var a={origin:decodeURIComponent(a[2]),destination:decodeURIComponent(a[3]),travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,avoidHighways:!1,avoidTolls:!0},f=this;(new google.maps.DirectionsService).route(a,function(a,c){if(c==google.maps.DirectionsStatus.OK){var e=a.routes[0].overview_path;d.setDirections(a);gasoleData._data=f.routeData(e);
b.textContent="Gasolineras en Ruta";stats=(new GasoleStats(gasoleData._data)).stats;computeWeights(stats);processData(gasoleData);document.getElementById("updated").textContent="("+formatUpdate(f.date)+")"}});return}stats=(new GasoleStats(gasoleData._data)).stats;computeWeights(stats);processData(gasoleData);document.getElementById("updated").textContent="("+formatUpdate(this.date)+")"})});(function(a){function e(a){!window.google||!window.google.maps?(window._geoCallback=a,a=document.createElement("script"),a.type="text/javascript",a.src="http://maps.googleapis.com/maps/api/js?key=AIzaSyD5XZNFlQsyWtYDeKual-OcqmP_5pgwbds&sensor=false&callback=_geoCallback",document.body.appendChild(a)):a()}function b(a,b,c,d){var f=this;f.href=null;var n=f.loader=document.createElement("div"),q=f.input=document.createElement("input"),u=f.list=document.createElement("ol");f.enable=function(a){a?f.input.removeAttribute("disabled"):
f.input.setAttribute("disabled","")};f.getPlace=function(){return f.href};f.geoCode=function(){var a=f.input.value;a&&(f.showLoader(!0),(new google.maps.Geocoder).geocode({address:a,region:"es"},function(a,b){f.showList(a,b)}))};f.showLoader=function(a){n.style.display=a?"block":"none"};f.init=function(a){f.href=a;f.input.value=decodeURIComponent(a.split("/")[0])};f.clearList=function(){u.innerHTML=""};f.showList=function(a,b){f.showLoader(!1);f.clearList();if(b==google.maps.GeocoderStatus.OK){for(var c=
function(a){f.href=a.getAttribute("data-place");q.value=a.textContent;f.clearList()},d=0,e,g,h=0;h<a.length;h++){var l=a[h].geometry.location;e=a[h].formatted_address;e.match(/Espa\u00f1a$/)&&(d++,g=document.createElement("li"),g.setAttribute("data-place",encodeURIComponent(e)+"/"+l.lat()+"/"+l.lng()),g.textContent=e,g.onclick=function(){c(this)},u.appendChild(g))}1==d&&c(g);if(0<d)return}u.innerHTML="<li>No se ha podido encontrar el lugar. Int\u00e9ntalo de nuevo.</li>"};a=document.getElementById(a);
c&&void 0!=navigator.geolocation&&(f.loadCurrentPosition=function(){navigator.geolocation.getCurrentPosition(function(a){var b=new google.maps.Geocoder;a=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);b.geocode({latLng:a},f.showList)},function(a){switch(a.code){case a.PERMISSION_DENIED:console.log("No has permitido que obtengamos tu posici\u00f3n.");break;case a.POSITION_UNAVAILABLE:console.log("No es posible obtener tu posici\u00f3n acual.");break;case a.TIMEOUT:console.log("Se ha agotado el tiempo de espera.");
break;case a.UNKNOWN_ERROR:console.log("Ha ocurrido un error desconocido.")}})},c=document.createElement("div"),c.className="sprt search_gps",c.onclick=function(){f.showLoader(!0);e(f.loadCurrentPosition)},a.appendChild(c));n.className="loader";a.appendChild(n);q.setAttribute("type","search");q.setAttribute("placeholder",b);a.appendChild(q);u.className="results";lockScroll(u);a.appendChild(u);a.onsubmit=function(){e(f.geoCode);return!1};q.onblur=function(){null==f.href&&e(f.geoCode)};q.onsearch=function(){f.clearList();
f.href=null;console.log("tetas")};f.enable(d)}function c(a){this.value=2;this.max=20;this.min=1;this.step=0.2;this.candidate=this.value;var b=this;sliderDiv=document.getElementById(a);barDiv=document.createElement("div");padDiv=document.createElement("div");sliderDiv.style.position="relative";barDiv.style.position="absolute";barDiv.style.left="0";barDiv.style.top="0";barDiv.className="bar";sliderDiv.appendChild(barDiv);padDiv.style.position="absolute";padDiv.style.top=padDiv.style.left=padDiv.style.right=
padDiv.style.bottom=0;sliderDiv.appendChild(padDiv);this.getvalue=function(){return Math.round(this.value/this.step)*this.step};this.updateSlider=function(a){barDiv.style.width=Math.round((a-b.min)*sliderDiv.clientWidth/(b.max-b.min))+"px";barDiv.textContent="Radio: "+a.toFixed(1)+" km."};this.updateSlider(this.value);addEvent(padDiv,"mousemove",function(a){a=a.clientX-2-this.getBoundingClientRect().left;a=b.min+a*(b.max-b.min)/this.clientWidth;a=Math.round(a/b.step)*b.step;a=Math.max(b.min,a);a=
Math.min(b.max,a);b.candidate=a;b.updateSlider(b.candidate)});addEvent(padDiv,"click",function(a){b.value=b.candidate;b.updateSlider(b.value)});addEvent(padDiv,"mouseout",function(a){b.updateSlider(b.value)});this.enable=function(a){sliderDiv.style.display=a?"block":"none"}}var d=null,f=null;addEvent(a,"load",function(){function a(){var b=d.getPlace();b&&(window.location="/resultados/"+b+"/"+sliderDist.getvalue().toFixed(1))}function e(){var a=d.getPlace(),b=f.getPlace();null!=a&&null!=b&&(window.location=
"/ruta/"+a.split("/")[0]+"/"+b.split("/")[0])}sliderDist=new c("search-d");d=new b("search-form","Gran V\u00eda 35, Madrid -o- Aeropuerto -o- Hotel Palace",!0,!0);f=new b("search-form-dest","Barcelona",!1,!1);var l=document.getElementById("menu-search"),p=document.getElementById("search-b");addEvent(l,"click",function(a){stopEvent(a);this.className="menu search enabled";addEvent(document,"click",function(){l.className="menu search"})});addEvent(document.getElementById("route"),"click",function(){var b=
null==this.className.match(" on");sliderDist.enable(!b);f.enable(b);this.className="sprt directions"+(b?" on":"");p.onclick=b?e:a});var m=window.location.pathname.split("/");"resultados"==m[1]&&(d.init(m.slice(2,5).join("/")),sliderDist.updateSlider(parseFloat(m[5])));p.onclick=a})})(window);
