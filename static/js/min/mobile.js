function searchLocation(a){var b="",c="",d="";"object"==typeof a?(b=a.geometry.location.lat(),c=a.geometry.location.lng(),d=encodeURI(a.formatted_address)):"string"==typeof a&&(c=a.split("##"),d=c[0],b=c[1],c=c[2]);a=document.getElementById("search-d").getAttribute("value");window.location="/resultados/"+d+"/"+b+"/"+c+"/"+a}
function showLoader(){document.getElementById("results-title").textContent="Buscando\u2026";var a=document.getElementById("results-list");a.innerHTML="";var b=new Image;b.src="/img/search-loader.gif";a.appendChild(b)}function initGeoloc(){var a=document.getElementById("current-loc");navigator.geolocation?a.addEventListener("click",loadCurrentPosition):a.style.display="none"}
function showResult(a,b){document.getElementById("results").style.display="block";var c=document.getElementById("results-list");c.innerHTML="";if(b==google.maps.GeocoderStatus.OK){for(var d=0,g=0,f=0;f<a.length;f++){var e=a[f].formatted_address;if(e.match(/Espa\u00f1a$/)){console.log(typeof a[f]);d++;var g=f,h=document.createElement("li"),l=document.createElement("a");h.appendChild(l);l.textContent=e;l.href="#";l.setAttribute("loc",[a[f].formatted_address,a[f].geometry.location.lat(),a[f].geometry.location.lng()].join("##"));
l.addEventListener("click",function(){searchLocation(this.getAttribute("loc"))});c.appendChild(h)}}if(1==d){searchLocation(a[g]);return}if(1<d){document.getElementById("results-title").textContent="Encontrados "+d+" lugares:";return}}c.innerHTML="<li>No se ha podido encontrar el lugar. Int\u00e9ntalo de nuevo</li>"}
function loadCurrentPosition(){showLoader();navigator.geolocation.getCurrentPosition(function(a){var b=new google.maps.Geocoder;a=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);b.geocode({latLng:a},showResult)},function(a){switch(a.code){case a.PERMISSION_DENIED:console.log("User denied the request for Geolocation.");break;case a.POSITION_UNAVAILABLE:console.log("Location information is unavailable.");break;case a.TIMEOUT:console.log("The request to get user location timed out.");break;
case a.UNKNOWN_ERROR:console.log("An unknown error occurred.")}})}function geoCode(){showLoader();var a=document.getElementById("address").value;(new google.maps.Geocoder).geocode({address:a,region:"es"},showResult)}
function mySlider(a){function b(a){var b=a.getElementsByClassName("val")[0],c=parseFloat(a.getAttribute("newval")),e=parseFloat(a.getAttribute("max")),h=parseFloat(a.getAttribute("min"));b.style.width=(c-h)*a.clientWidth/(e-h)-5+"px";b.textContent="Radio: "+c.toFixed(1)+" km.";a.setAttribute("value",c)}a.style.position="relative";var c=document.createElement("div");c.style.position="absolute";c.style.left="0";c.style.top="0";c.textContent="Radio: "+a.getAttribute("value")+" km.";c.className="val";
a.appendChild(c);c=document.createElement("div");c.style.position="absolute";c.style.left="0";c.style.top="0";c.className="new-val";c.style.display="none";a.appendChild(c);a.setAttribute("newval",a.getAttribute("value"));b(a);a.addEventListener("mousemove",function(a){var b=this.getElementsByClassName("new-val")[0];b.style.display="block";var c=a.clientX-this.getBoundingClientRect().left;b.style.width=c-5+"px";a=parseFloat(this.getAttribute("max"));var e=parseFloat(this.getAttribute("min")),h=parseFloat(this.getAttribute("step")),
c=e+c*(a-e)/this.clientWidth,c=parseInt(c/h)*h;c<e&&(c=e);c>a&&(c=a);b.textContent="Radio: "+c.toFixed(1)+" km.";this.setAttribute("newval",c)});a.addEventListener("click",function(a){this.getElementsByClassName("new-val")[0].style.display="none";b(this)});a.addEventListener("mouseout",function(a){this.getElementsByClassName("new-val")[0].style.display="none"})}
window.addEventListener("load",function(){for(var a=document.getElementsByClassName("my-slider"),b=0;b<a.length;b++)mySlider(a[b]);if(a=document.getElementById("map")){a=a.getElementsByClassName("prov");for(b=0;b<a.length;b++)a[b].addEventListener("click",function(){})}initGeoloc()});function distance(a,b,c){var d=111.03461*Math.abs(a[0]-b[0]);if(d<c&&(a=85.39383*Math.abs(a[1]-b[1]),a<c&&(d=Math.sqrt(Math.pow(d,2)+Math.pow(a,2)),d<c)))return d}function Sound(a){this.html5audio=document.getElementById(a);this.play=function(){this.html5audio&&(this.html5audio.pause(),this.html5audio.play())}}
var click=null,loader="<img src='data:image/gif;base64,R0lGODlhEAAQAPQAAMzMzP///83NzfLy8uTk5Pz8/Pb29tPT09zc3Pn5+ebm5unp6dHR0eDg4NfX1+/v7+3t7QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAAFUCAgjmRpnqUwFGwhKoRgqq2YFMaRGjWA8AbZiIBbjQQ8AmmFUJEQhQGJhaKOrCksgEla+KIkYvC6SJKQOISoNSYdeIk1ayA8ExTyeR3F749CACH5BAkKAAAALAAAAAAQABAAAAVoICCKR9KMaCoaxeCoqEAkRX3AwMHWxQIIjJSAZWgUEgzBwCBAEQpMwIDwY1FHgwJCtOW2UDWYIDyqNVVkUbYr6CK+o2eUMKgWrqKhj0FrEM8jQQALPFA3MAc8CQSAMA5ZBjgqDQmHIyEAIfkECQoAAAAsAAAAABAAEAAABWAgII4j85Ao2hRIKgrEUBQJLaSHMe8zgQo6Q8sxS7RIhILhBkgumCTZsXkACBC+0cwF2GoLLoFXREDcDlkAojBICRaFLDCOQtQKjmsQSubtDFU/NXcDBHwkaw1cKQ8MiyEAIfkECQoAAAAsAAAAABAAEAAABVIgII5kaZ6AIJQCMRTFQKiDQx4GrBfGa4uCnAEhQuRgPwCBtwK+kCNFgjh6QlFYgGO7baJ2CxIioSDpwqNggWCGDVVGphly3BkOpXDrKfNm/4AhACH5BAkKAAAALAAAAAAQABAAAAVgICCOZGmeqEAMRTEQwskYbV0Yx7kYSIzQhtgoBxCKBDQCIOcoLBimRiFhSABYU5gIgW01pLUBYkRItAYAqrlhYiwKjiWAcDMWY8QjsCf4DewiBzQ2N1AmKlgvgCiMjSQhACH5BAkKAAAALAAAAAAQABAAAAVfICCOZGmeqEgUxUAIpkA0AMKyxkEiSZEIsJqhYAg+boUFSTAkiBiNHks3sg1ILAfBiS10gyqCg0UaFBCkwy3RYKiIYMAC+RAxiQgYsJdAjw5DN2gILzEEZgVcKYuMJiEAOwAAAAAAAAAAAA==' /><br>",pump_marker=
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAwCAYAAABjezibAAAFmklEQVRYhd2ZP3DaSBTGvycyk8YemEljaEwVSiPUXIfSx3NcdyGFSUPK+DLpgT7kaKEJbkzrjFPcpLFc5YoIlFJpzmkw6UjkKjPoXbFaWRYSf2R8xX0zO4NWu9of763e7j4REkjTtPRsNtMVRSkSURFAJqbplJkt13WtVCplmKb5fd2xaJ3GqqruEdEhgAoRxUFFipmnAE6YuTMajT5vFFBV1bKiKE0AetR9TdMi+9m2jaurq6hbhuu6zdFodH4rQE3T0szc9KzmK5vNYn9/H+VyGYVCYeEAjuPAMAwYhgHTNG8AM3OHiJqLXB8L6LnzhIjyAWA8fvwY+/v7C6HiNB6P0ev1YBiGD8rMF8xciXN7JKCqqrtEZMl5trW1hXq9jmq1mggsLNu20Wq18OXLFwk5ZWY9CnIOUNO0NAADQBEQ7nz9+vVSVybR8fEx3rx5sxBSieh3A+74+PgmnGUBxSJAtLjk80CtdvPJ0ymg68ChmNLVahX1eh0AQEQZIjJUVd0NdrlhwVKp9Kd8Iba2ttDtdlG4fx/odASYHOTzilEinRZ/BhDAug48eyauDw6Afh+O4+D58+e+uwFYpmmqc89SVbWsaRrL8unTJ2Zm5rMzZmAz5cUL5rdvr68PDpiZ+cePH1wul/2xS6VSQ3L5Liaivvxdr9djY9utlMkItze88Y+OgFoN29vbaLfbfjMiakpXKwCgadqBDCfZbNafF5FqNFa32dlZ/HPSaWBvT0B2On4IC0L6gABq8sZCuE0pkxGl2RTX02nU2BVN09KKZ0oduF4h7ly6LqAkoKdcLudb0YvBFUVRlIps8OTJk7sFMwwBZVlAv+9bLqgQQ0VBYAOg6zruVOfnQKslQs3FxXycBFAoFJDNZgEAzKwrAPKAcG8ul7tbwN1dUYBI60nJCEJEGQXeqnHncICwWITVwgqy+HHwTuJeQgVZotbixWq1lq/Dsjx6dGvY9QH/Y/mAjuNEt8jngXJZlKTa2xP95cZhiYIs9+SPwG5iHtAwxO9icfWdTFCGIVYO4HpXtEBBFgVi/4fxeLx8oCRxcm/vGm5FBVkUAFMAuLy8XA6ZBDBBH9M0AYhdtm9BADAMI7rHLQZbt49t27i8vAQAEJGhuK7rU71//35x70xm/ZelUomub7VECSnEYCjeIcUCxOSU5o3VOhaJ+jP5/HydN0cdx8Hp6WnwTl+GmY6s6fV6mwOMalurzW9svUPUYDAInpf7pml+9w9NpVLpH7mrfvny5fUZ2LL8B/g6X5qxEAq/wYeHsS63bRtPnz71r13XzY9Go6/3AhWHqVTqBBBW1DRNHDen09WBwgrHTF2PBHQcB63AfPQSTF+BQKC2LOudpmknACpXV1dotVrodrvYTvJixClq/gFot9vBLMOFPI8AoXOxlyyypKsfPnyIRqNxJ1mFINxgMPCvXdctBrMLc6kPL2lkBPMy3W5345CO46DdbofDSs00zaNgRSrccTKZfNvZ2fmLiH4BsPPz5098+PABDx482Bikbdt49eoVPn78KKss13V/Hw6H78JtY9Nv4SQSAJTLZVSr1cSbW8dx0Ov1cHp6GswTWgD0uBzh0gxrMF8TgF8rT2jbNgaDwY28ICDe1uFw+MeiviulgIvF4q+pVKqJgDWDsHEWHY/Hc1CerNls1rQsa86liQBDoDUAMQvsUp3MZrP+KmBSawFKqaq66x34dWbW4zL+zDwlIgMiaX4ig+//SoksKFUqlRpEpDPzBYCLyAGIiqZp/pZ0jHvLm8SLiDrMfEhEelwb13Vj762iWx07TdP87rpuLe4+M6/0sWaR5laSdTWZTOxsNpvxVp6gjOFw+Oy2z9/Iwd3bffjnSe+7XNJQdEMbAQy7mpkrSb5sRunWLpaaTCbfcrnclJn/Ho1GR8t7rKZ/AacjxLFPJTdmAAAAAElFTkSuQmCC";
function initMap(){var a={mapTypeId:google.maps.MapTypeId.ROADMAP},b=document.getElementById("map-art");map=new google.maps.Map(b,a)}function Stats(){this.n=0;this.max=this.min=this.mu=this.range=null;this.add=function(a){this.max?(a>this.max?this.max=a:a<this.min&&(this.min=a),this.mu=(this.mu*this.n+a)/(this.n+1),this.range=this.max-this.min):this.max=this.min=this.mu=a;this.n++}}
function Gasole(){this.date=this.info=this.stats=null;this.type="1";this.color=function(a){if(0!=this.stats.range){a=(a-this.stats.min)/this.stats.range;if(0.33>a)return COLORS.min;if(0.66<a)return COLORS.max}return COLORS.mu};this.init=function(a,b){this.info=a;this.date=b};this.provinceData=function(a){this.stats=new Stats;var b=this.type;this.result={};a=this.info[a];for(var c in a){var d=a[c],g;for(g in d){var f=d[g],e=f.o[b];e&&(this.result[g]=f,this.stats.add(e))}}return this.result};this.nearData=
function(a,b){var c=a.latlng();if(c){var d=a.radius;this.stats=new Stats;"undefined"==typeof b&&(b="p");result=[];var g=this.type,f;for(f in this.info){var e=this.info[f],h;for(h in e){var l=e[h],n;for(n in l){var m=l[n],p=m.o[g];if(p){var q=m.g;if(q){var r=distance(q,c,d);r&&(result.push({a:n,r:m.r,g:q,p:p,t:h,l:m.l,d:r}),this.stats.add(p))}}}}}return result.sort(function(a,c){return a[b]<c[b]?-1:1})}}}var map=null,gasole=new Gasole,markerDetail=null;
function SearchLocations(){this.locs=[];this.radius=2;this.length=function(){return this.locs.length};this.add=function(a,b){this.locs.push({name:a,latlng:b})};this.latlng=function(){return 1==this.length()?this.locs[0].latlng:null};this.name=function(){return 1==this.length()?this.locs[0].name:null};this.get=function(a){return this.locs[a]};this.select=function(a){this.locs=[this.locs[a]]};this.clear=function(){this.locs=[]}}var theLocation=new SearchLocations,bounds=null,markers=[];
function clearMarkers(){for(var a=0;a<markers.length;a++)markers[a].setMap(null);markers=[]}
function showList(a){if(a){map||initMap();var b=$$("#list");b.html("");var c={icon:{path:google.maps.SymbolPath.CIRCLE,strokeOpacity:1,strokeWeight:1,fillOpacity:0.8,scale:6,strokeColor:"fff"},map:map};bounds=new google.maps.LatLngBounds;clearMarkers();var d=a.length;if(0==d)b.html("<li class='error'><div class='icon warning'></div><strong>Ning\u00fan resultado.<br>Prueba aumentando el radio de b\u00fasqueda.</strong></li>");else{var g;g="<strong>Se han encontrado "+d+" puntos de venta de "+(FUEL_OPTIONS[gasole.type].name+
" cerca de "+theLocation.name());g+=", con un precio medio de "+gasole.stats.mu.toFixed(3)+" \u20ac/l</strong>";b.html("<li class='title'>"+g+"</li><li><strong>Ordena los resultados:</strong><div class='right price sort on'>\u20ac/l</div><div class='right dist sort'>km.</div></li>");for(var f=0;f<d;f++){var e=a[f];g="<strong>"+e.l+"</strong>";var h="<small>"+e.a+"</small>",l="<div class='right price'>"+e.p.toFixed(3)+"</div>",n="<div class='right dist'>"+e.d.toFixed(1)+"</div>",m=document.createElement("li");
m.id="s-"+f;$$(m).html(g+l+n+h).tap(function(){showDetail(parseInt(this.id.split("-")[1]))});b.append(m);g=new google.maps.LatLng(e.g[0],e.g[1]);bounds.extend(g);c.position=g;marker=new google.maps.Marker(c);console.log(gasole.color(e.p));marker.icon.fillColor=gasole.color(e.p);google.maps.event.addListener(marker,"click",function(){showDetail(markers.indexOf(this))});markers.push(marker)}b.append("<li><strong>Fin de los resultados</strong></li>")}Lungo.Router.article("results-sec","list-art")}}
function searchResults(){var a=$$("#search-input").val();a&&a!=theLocation.name()?(theLocation.clear(),(new google.maps.Geocoder).geocode({address:a,region:"es"},function(a,c){if(c==google.maps.GeocoderStatus.OK){for(var d=0;d<a.length;d++){var g=a[d].formatted_address;g.match(/Espa\u00f1a$/)&&theLocation.add(g,[a[d].geometry.location.lat(),a[d].geometry.location.lng()])}d=theLocation.length();if(1<d){for(var g="<h1>Encontrados "+d+" lugares:</h1>",f="",e=0;e<d;e++)f+="<li class='result icon pushpin' data-loc='"+
e+"'>"+theLocation.get(e).name+"</li>";Lungo.Notification.html(g+"<ul>"+f+"</ul>","Cancelar");$$(".result").tap(function(){Lungo.Notification.hide();theLocation.select(parseInt(this.getAttribute("data-loc")));$$("#search-input").val(theLocation.name());searchResults()})}else $$("#search-input").val(theLocation.name()),searchResults()}})):showList(gasole.nearData(theLocation))}
function initControl(){var a=gasole.date,b=(new Date).toLocaleDateString()==a.toLocaleDateString()?"hoy":"el "+a.getDate()+" de "+MONTHS[a.getMonth()];$$("#info").text("Precios actualizados "+b+" a las "+a.toLocaleTimeString().split(":").splice(0,2).join(":"));Lungo.dom("#map-art").on("load",function(){google.maps.event.trigger(map,"resize");map.fitBounds(bounds)});$$(".type").tap(function(){click.play();gasole.type=this.getAttribute("data-type");$$(".type").removeClass("sel");this.className+=" sel";
$$("#typename").text(FUEL_OPTIONS[gasole.type].name)});$$(".d").tap(function(){click.play();theLocation.radius=parseInt(this.getAttribute("data-d"));$$(".d").removeClass("sel");this.className+=" sel";$$("#dist").text(theLocation.radius)});$$(".p").tap(function(){var a=gasole.provinceData($$(this).text(),$$(".sel")[0].getAttribute("data-type"));showList(a)});$$("#search-button").tap(searchResults);$$("#location").tap(function(){var a=$$("#search-input"),b=$$("#search");if(b.hasClass("current"))$$(".locate").style("color",
"#ccc"),a.val("").removeAttr("readonly"),theLocation.clear(),b.toggleClass("current");else{$$(this).addClass("spinner");a.val("Obteniendo posici\u00f3n.");var g=setInterval(function(){a.val(a.val()+".")},100);navigator.geolocation.getCurrentPosition(function(f){clearInterval(g);$$(".locate").removeClass("spinner").style("color","#fff");theLocation.clear();b.toggleClass("current");a.val("Mi posici\u00f3n actual").attr("readonly",!0);theLocation.add(a.val(),[f.coords.latitude,f.coords.longitude])},
function(b){clearInterval(g);$$(".locate").removeClass("spinner");Lungo.Notification.show("No se puede obtener tu posici\u00f3n","warning",3);a.val("")},{timeout:5E3})}});$$(".sort").tap(function(){showList(gasole.nearData(theLocation,$$(this).hasClass("price")?"p":"d"));$$(".sort").removeClass("on");this.className+=" on"})}
function showDetail(a){console.log(a);map.panTo(markers[a].position);map.setZoom(15);Lungo.Router.article("results-sec","map-art");markerDetail?(markerDetail.setPosition(markers[a].position),markerDetail.setAnimation(google.maps.Animation.BOUNCE)):markerDetail=new google.maps.Marker({map:map,position:markers[a].position,animation:google.maps.Animation.BOUNCE,icon:pump_marker})}
window.addEventListener("load",function(){Lungo.init({name:"GasOl\u00e9"});var a=localStorage.gasole;!a||(new Date).getTime()-parseInt(JSON.parse(a).ts)>LS_EXPIRE?(console.log("buscando nuevos datos"),Lungo.Notification.show("<div class='icon refresh spinner'></div>Actualizando Datos\u2026"),a=new XMLHttpRequest,a.onload=function(){var a=new Date;gasole.init(JSON.parse(this.responseText),a);localStorage.setItem("gasole",'{"ts": '+a.getTime()+',"data": '+this.responseText+"}");Lungo.Notification.hide();
initControl()},a.open("GET","/api/All"),a.send()):(console.log("datos recuperados"),a=JSON.parse(a),gasole.init(a.data,new Date(a.ts)),initControl());click=new Sound("click")});var FUEL_OPTIONS={1:{"short":"G95",name:"Gasolina 95"},3:{"short":"G98",name:"Gasolina 98"},4:{"short":"GOA",name:"Gas\u00f3leo Automoci\u00f3n"},5:{"short":"NGO",name:"Nuevo Gas\u00f3leo A"},6:{"short":"GOB",name:"Gas\u00f3leo B"},7:{"short":"GOC",name:"Gas\u00f3leo C"},8:{"short":"BIOD",name:"Biodi\u00e9sel"}},CHART_OPTIONS=[{id:"G98",color:"#339933",name:"Gasolina 98"},{id:"G95",color:"#006633",name:"Gasolina 95"},{id:"NGO",color:"#aaa",name:"Nuevo Gas\u00f3leo A"},{id:"BIOD",color:"#f1aa41",name:"Biodi\u00e9sel"},
{id:"GOA",color:"#000",name:"Gas\u00f3leo A"},{id:"GOC",color:"#FF3300",name:"Gas\u00f3leo C"},{id:"GOB",color:"#CC3333",name:"Gas\u00f3leo B"}],PROVS={"\u00c1lava":"01",Albacete:"02",Alicante:"03","Almer\u00eda":"04",Asturias:"33","\u00c1vila":"05",Badajoz:"06","Balears (Illes)":"07",Barcelona:"08",Burgos:"09","C\u00e1ceres":"10","C\u00e1diz":"11",Cantabria:"39","Castell\u00f3n / Castell\u00f3":"12",Ceuta:"51","Ciudad Real":"13","C\u00f3rdoba":"14","Coru\u00f1a (A)":"15",Cuenca:"16",Girona:"17",
Granada:"18",Guadalajara:"19","Guip\u00fazcoa":"20",Huelva:"21",Huesca:"22","Ja\u00e9n":"23","Le\u00f3n":"24",Lleida:"25",Lugo:"27",Madrid:"28","M\u00e1laga":"29",Melilla:"52",Murcia:"30",Navarra:"31",Ourense:"32",Palencia:"34","Palmas (Las)":"35",Pontevedra:"36","Rioja (La)":"26",Salamanca:"37","Santa Cruz De Tenerife":"38",Segovia:"40",Sevilla:"41",Soria:"42",Tarragona:"43",Teruel:"44",Toledo:"45","Valencia / Val\u00e8ncia":"46",Valladolid:"47",Vizcaya:"48",Zamora:"49",Zaragoza:"50"},MONTHS="Enero Febrero Marzo Abril Mayo Junio Julio Agosto Septiembre Octubre Noviembre Diciembre".split(" "),
COLORS={min:"#36AE34",minStroke:"#fff",max:"#f00",maxStroke:"#fff",mu:"#3399CC",muStroke:"#fff"},info=null,LS_EXPIRE=36E5,APIS={gasolineras:"api",resultados:"geo",ficha:"api"};function getProvName(a){for(k in PROVS)if(PROVS[k]==a)return k}function clearHtmlTags(a){return a.replace(/(<([^>]+)>)/ig,"")}
function toTitle(a){return a.replace(" [N]","").replace(/^CARRETERA ?|^CR\.? ?/i,"CTRA. ").replace(/(CTRA. )+/i,"CTRA. ").replace(/^AVENIDA ?|^AV. ?/i,"AVDA. ").replace(/^POLIGONO INDUSTRIAL ?|POLIGONO ?|P\.I\. ?/i,"POL. IND. ").replace(/^CALLE |^CL\.? ?|C\/ ?/i,"C/ ").replace(/^RONDA |^RD /i,"RDA. ").replace(/^AUTOPISTA (AUTOPISTA ?)?/i,"AU. ").replace(/^PLAZA ?/i,"PL. ").replace(/^PASEO (PASEO ?)?/i,"P\u00ba ").replace(/^TRAVESS?[I\u00cd]A /i,"TRAV. ").replace(/^V[i\u00ed]A (V[I\u00cd]A )?/i,"V\u00cdA ").replace(/\B[^\d- ]+[ $]/g,
function(a){return a.toLowerCase()}).replace(/\b[NAE]-.+\b/,function(a){return a.toUpperCase()}).replace(/\[D\]$/,"(m.d.)").replace(/\[I\]$/,"(m.i.)").replace(/ \[N\]$/,"")}
function getLogo(a){return a&&(a=a.replace(/camspa/i,"campsa"),logo=a.match(/\b(abycer|agla|alcampo|andamur|a\.?n\.? energeticos|avia|bonarea|b\.?p\.?|buquerin|campsa|carmoned|carrefour|cepsa|empresoil|eroski|esclatoil|galp|gasolben|iberdoex|leclerc|makro|meroil|norpetrol|petrem|petrocat|petromiralles|petronor|repostar|repsol|saras|shell|simply|staroil|tamoil|valcarce)\b/i))?logo[0].replace(/\./g,"").replace(/ /g,"_").toLowerCase():null}
function decodeName(a){return decodeURI(a).replace(/_/g," ").replace(/\|/g,"/")}function prettyName(a){a.match("/")&&(a=a.split("/")[1]);a.match(/\)$/)&&(a=a.match(/\(.+\)$/g)[0].replace("(","").replace(")"," ")+a.split(" (")[0]);return a}function decodeArray(a){for(var b=0;b<a.length;b++)a[b]=decodeName(a[b]);return a}function encodeName(a){return a.replace(/\//g,"|").replace(/ /g,"_")}function checkLocalStorage(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}}
function getApiData(a,b,c){var d=new XMLHttpRequest;d.onload=function(a){info=JSON.parse(a.target.responseText);b&&(localStorage.setItem(b,JSON.stringify(info)),localStorage.timestamp||localStorage.setItem("timestamp",(new Date).getTime()));c(info)};d.open("GET",a);d.send()}function getKey(){return window.location.pathname.split("/").slice(1).join("***")}
function getData(a){var b=null,c=null,d=window.location.pathname.split("/"),g=d[1];if(checkLocalStorage()){(b=localStorage.timestamp)&&(new Date).getTime()-parseInt(b)>LS_EXPIRE&&localStorage.clear();var b=getKey(),f=localStorage[b];if(f)c=JSON.parse(f);else if("gasolineras"==g&&d[3]&&(f=localStorage[d.slice(1,3).join("***")])){var e=decodeName(d[2]),d=decodeName(d[3]),c={_data:{}};c._data[e]={};c._data[e][d]=JSON.parse(f)._data[e][d]}}c?a(c):getApiData(document.URL.replace(g,APIS[g]),b,a)};
